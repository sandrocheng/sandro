package com.keniu.security.malware;

import android.content.Context;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.database.Cursor;
import android.text.TextUtils;
import com.hoi.antivirus.AntiVirusFunc;
import com.keniu.security.c.b;
import java.io.File;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public final class bd
{
  public static final int a = 1;
  public static final int b = 2;
  public static final int c = 4;
  public static final int d = 128;
  public static final int e = 1;
  public static final int f = 2;
  public static final int g = 9;
  public static final int h = 27;
  private static final Object l = new Object();
  private static final Object m = new Object();
  private PackageManager i;
  private b j;
  private b k;
  private Context n;
  private long o = 0L;

  private void a(List paramList)
  {
    if (paramList == null)
      return;
    r localr = new r(this.n);
    Cursor localCursor = localr.b();
    if (localCursor != null)
      if (!localCursor.moveToFirst());
    label256: 
    while (true)
    {
      String str = localCursor.getString(localCursor.getColumnIndex("publicsourcedir"));
      int i1 = localCursor.getInt(localCursor.getColumnIndex("malwarelocation"));
      if (new File(str).exists())
        if (i1 == 1)
        {
          Iterator localIterator = paramList.iterator();
          while (localIterator.hasNext())
          {
            ApplicationInfo localApplicationInfo = (ApplicationInfo)localIterator.next();
            if (localApplicationInfo.publicSourceDir.equals(str))
            {
              paramList.remove(localApplicationInfo);
              paramList.add(0, localApplicationInfo);
            }
          }
        }
      while (true)
      {
        if (localCursor.moveToNext())
          break label256;
        localCursor.close();
        localr.a();
        break;
        if (i1 == 2)
        {
          PackageInfo localPackageInfo = this.i.getPackageArchiveInfo(str, 128);
          if ((localPackageInfo != null) && (localPackageInfo.applicationInfo != null))
          {
            if (localPackageInfo.applicationInfo.publicSourceDir == null)
              localPackageInfo.applicationInfo.publicSourceDir = str;
            paramList.add(0, localPackageInfo.applicationInfo);
          }
          else
          {
            localr.b(str);
            continue;
            localr.b(str);
          }
        }
      }
    }
  }

  private boolean a(File paramFile)
  {
    boolean bool;
    if (paramFile.getPath().startsWith("/system/app/"))
      bool = true;
    while (true)
    {
      return bool;
      if (paramFile.lastModified() < 86400000L + this.o)
        bool = true;
      else
        bool = false;
    }
  }

  private static boolean b(String paramString)
  {
    if ((paramString == null) || (paramString.length() != 32) || (paramString.equals("00000000000000000000000000000000")));
    for (boolean bool = false; ; bool = true)
      return bool;
  }

  private void c(com.keniu.security.d.d paramd)
  {
    r localr = new r(this.n);
    localr.a(paramd.s, paramd.t, paramd.u, paramd.q);
    localr.a();
  }

  public final com.keniu.security.d.d a(String paramString, int paramInt)
  {
    String str;
    int i1;
    com.keniu.security.d.d locald2;
    if ((paramInt & 0x1) != 0)
    {
      str = new AntiVirusFunc().a(paramString);
      if ((str == null) || (str.length() != 32) || (str.equals("00000000000000000000000000000000")))
      {
        i1 = 0;
        if (i1 == 0)
          break label214;
        synchronized (l)
        {
          if (this.j != null)
          {
            locald2 = this.j.a(str);
            if ((locald2 != null) && (locald2.b()))
              locald2.r = d.a(new File(paramString));
            label102: if (locald2 != null);
          }
        }
      }
    }
    while (true)
    {
      synchronized (m)
      {
        if (this.k != null)
          locald2 = this.k.a(str);
        locald1 = locald2;
        if (locald1 == null)
        {
          locald1 = new com.keniu.security.d.d();
          locald1.s = 1;
        }
        if (locald1.q == null)
          locald1.q = str;
        return locald1;
        i1 = 1;
        break;
        localObject2 = finally;
        throw localObject2;
      }
      com.keniu.security.d.d locald1 = locald2;
      continue;
      locald2 = null;
      break label102;
      label214: locald1 = null;
      continue;
      str = null;
      locald1 = null;
    }
  }

  public final ArrayList a(List paramList, boolean[] paramArrayOfBoolean)
  {
    int i1 = paramList.size();
    String[] arrayOfString = new String[i1];
    new ArrayList();
    ArrayList localArrayList1 = new ArrayList();
    for (int i2 = 0; i2 < i1; i2++)
      arrayOfString[i2] = ((AppMettle)paramList.get(i2)).a.publicSourceDir;
    ArrayList localArrayList2 = o.a(arrayOfString, paramArrayOfBoolean);
    int i3 = 0;
    if (localArrayList2 == null)
    {
      new ArrayList();
      for (int i4 = 0; i4 < i1; i4++)
        localArrayList1.add(((AppMettle)paramList.get(i4)).b);
    }
    if (i3 < i1)
    {
      com.keniu.security.d.d locald = (com.keniu.security.d.d)localArrayList2.get(i3);
      locald.q = ((AppMettle)paramList.get(i3)).b.q;
      if (TextUtils.isEmpty(locald.t))
        locald.t = "Virus.Client.Def";
      if (locald.a());
      while (true)
      {
        synchronized (m)
        {
          if (this.k != null)
            this.k.a(locald);
          localArrayList1.add(locald);
          i3++;
        }
        synchronized (l)
        {
          if (this.j != null)
            this.j.a(locald);
          if (locald.r == null)
            if (((AppMettle)paramList.get(i3)).b.r == null)
              locald.r = d.a(new File(((AppMettle)paramList.get(i3)).a.publicSourceDir));
        }
      }
    }
    return localArrayList1;
  }

  public final void a()
  {
    if (this.j != null)
    {
      this.j.a();
      this.j = null;
    }
    if (this.k != null)
    {
      this.k.a();
      this.k = null;
    }
    this.i = null;
  }

  public final void a(int paramInt, com.keniu.security.d.d paramd, ApplicationInfo paramApplicationInfo, boolean paramBoolean)
  {
    r localr;
    if ((paramApplicationInfo != null) && (paramApplicationInfo.publicSourceDir != null))
    {
      localr = new r(this.n);
      if (!paramd.b())
        break label55;
      localr.a(paramd.t, paramApplicationInfo.packageName, paramApplicationInfo.publicSourceDir, paramInt);
    }
    while (true)
    {
      localr.a();
      return;
      label55: if (paramBoolean)
        localr.b(paramApplicationInfo.publicSourceDir);
    }
  }

  public final void a(Context paramContext)
  {
    this.n = paramContext;
    this.i = paramContext.getPackageManager();
    this.o = new File("/system/app/").lastModified();
    this.j = new b(this.n, false);
    this.k = new b(this.n, true);
  }

  public final void a(com.keniu.security.d.d paramd)
  {
    r localr = new r(this.n);
    Cursor localCursor = localr.c(paramd.q);
    if (localCursor != null)
    {
      if (!localCursor.moveToFirst())
        break label96;
      do
        if (localCursor.getInt(localCursor.getColumnIndex("software_type")) != paramd.s)
          localr.a(paramd.s, paramd.t, paramd.u, paramd.q);
      while (localCursor.moveToNext());
    }
    while (true)
    {
      localCursor.close();
      localr.a();
      return;
      label96: localr.a(paramd.q, paramd.s, paramd.t, paramd.u);
    }
  }

  public final boolean a(AppMettle paramAppMettle)
  {
    File localFile = new File(paramAppMettle.a.publicSourceDir);
    int i1;
    if (localFile.getPath().startsWith("/system/app/"))
      i1 = 1;
    boolean bool;
    while (i1 != 0)
    {
      bool = false;
      return bool;
      if (localFile.lastModified() < 86400000L + this.o)
        i1 = 1;
      else
        i1 = 0;
    }
    r localr = new r(this.n);
    Cursor localCursor = localr.c(paramAppMettle.b.q);
    int i3;
    if (localCursor != null)
      if ((localCursor.getCount() != 0) && (localCursor.moveToFirst()))
      {
        do
          i3 = localCursor.getInt(localCursor.getColumnIndex("software_type"));
        while (localCursor.moveToNext());
        label146: localCursor.close();
      }
    for (int i2 = i3; ; i2 = 0)
    {
      localr.a();
      if ((i2 == 1) || (i2 == 3))
      {
        bool = true;
        break;
      }
      bool = false;
      break;
      i3 = 0;
      break label146;
    }
  }

  public final boolean a(bh parambh)
  {
    return new bf(this, parambh).a();
  }

  public final boolean a(String paramString)
  {
    r localr = new r(this.n);
    Cursor localCursor = localr.a(paramString);
    boolean bool = false;
    if (localCursor != null)
    {
      int i1 = localCursor.getCount();
      bool = false;
      if (i1 != 0)
        bool = true;
      localCursor.close();
    }
    localr.a();
    return bool;
  }

  public final boolean a(List paramList, bh parambh)
  {
    return new be(this, parambh).a(paramList);
  }

  public final void b(com.keniu.security.d.d paramd)
  {
    r localr = new r(this.n);
    localr.a(paramd.s, paramd.t, paramd.u, paramd.q);
    localr.a();
  }

  public final boolean b(bh parambh)
  {
    return new bg(this, parambh).a();
  }
}

/* Location:           C:\Users\sandrocheng.21KUNPENG\Desktop\classes_dex2jar\
 * Qualified Name:     com.keniu.security.malware.bd
 * JD-Core Version:    0.6.2
 */