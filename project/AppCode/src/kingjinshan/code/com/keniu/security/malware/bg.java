package com.keniu.security.malware;

import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.os.Environment;
import android.os.StatFs;
import com.keniu.security.d.d;
import java.io.File;
import java.util.List;

final class bg
{
  private bh b;
  private int c;
  private long d = 0L;
  private long e = 0L;
  private long f = 0L;
  private long g = 1L;

  public bg(bd parambd, bh parambh)
  {
    this.b = parambh;
    this.c = 1;
    File localFile = Environment.getExternalStorageDirectory();
    if (localFile != null)
    {
      StatFs localStatFs = new StatFs(localFile.getPath());
      this.g = localStatFs.getBlockSize();
      this.f = (localStatFs.getBlockCount() - localStatFs.getAvailableBlocks());
    }
  }

  private boolean a(File paramFile)
  {
    String[] arrayOfString1 = paramFile.list();
    int i;
    String str;
    boolean bool;
    label84: ApplicationInfo localApplicationInfo;
    label226: d locald;
    if (arrayOfString1 != null)
    {
      i = 0;
      if (i < arrayOfString1.length)
      {
        str = paramFile.getPath() + File.separator + arrayOfString1[i];
        File localFile = new File(str.toString());
        if (localFile.isDirectory())
        {
          if (!a(localFile))
          {
            bool = false;
            return bool;
          }
        }
        else
        {
          this.e += localFile.length();
          if (this.e >= this.g)
          {
            this.d += this.e / this.g;
            this.e %= this.g;
          }
          if ((!str.toLowerCase().endsWith(".apk")) || (this.a.a(str)))
            break label341;
          PackageInfo localPackageInfo = bd.a(this.a).getPackageArchiveInfo(str, 128);
          if ((localPackageInfo == null) || (localPackageInfo.applicationInfo == null))
            break label335;
          if (localPackageInfo.applicationInfo.publicSourceDir == null)
            localPackageInfo.applicationInfo.publicSourceDir = str;
          localApplicationInfo = localPackageInfo.applicationInfo;
          locald = this.a.a(str, this.c);
          this.a.a(2, locald, localApplicationInfo, false);
        }
      }
    }
    while (true)
    {
      String[] arrayOfString2 = new String[1];
      d[] arrayOfd = new d[1];
      ApplicationInfo[] arrayOfApplicationInfo = new ApplicationInfo[1];
      arrayOfString2[0] = str;
      arrayOfd[0] = locald;
      arrayOfApplicationInfo[0] = localApplicationInfo;
      if (!this.b.a((float)this.d / (float)this.f, arrayOfString2, arrayOfd, arrayOfApplicationInfo))
      {
        bool = false;
        break label84;
      }
      i++;
      break;
      bool = true;
      break label84;
      label335: localApplicationInfo = null;
      break label226;
      label341: localApplicationInfo = null;
      locald = null;
    }
  }

  public final boolean a()
  {
    List localList = bd.a(this.a).getInstalledApplications(128);
    bd.a(this.a, localList);
    int i = localList.size();
    for (int j = 0; j < i; j++)
    {
      ApplicationInfo localApplicationInfo2 = (ApplicationInfo)localList.get(j);
      File localFile3 = new File(localApplicationInfo2.publicSourceDir);
      if ((0x40000 & localApplicationInfo2.flags) == 0)
        this.f += localFile3.length() / this.g;
    }
    int k;
    boolean bool;
    if (localList != null)
    {
      String[] arrayOfString = new String[9];
      d[] arrayOfd = new d[9];
      ApplicationInfo[] arrayOfApplicationInfo = new ApplicationInfo[9];
      k = 0;
      if (k < i)
      {
        ApplicationInfo localApplicationInfo1 = (ApplicationInfo)localList.get(k);
        if (localApplicationInfo1 != null)
        {
          int m = k % 9;
          File localFile2 = new File(localApplicationInfo1.publicSourceDir);
          this.e += localFile2.length();
          if (this.e >= this.g)
          {
            this.d += this.e / this.g;
            this.e %= this.g;
          }
          d locald = this.a.a(localApplicationInfo1.publicSourceDir, this.c);
          bd localbd = this.a;
          localbd.a(1, locald, localApplicationInfo1, false);
          arrayOfString[m] = localApplicationInfo1.publicSourceDir;
          arrayOfd[m] = locald;
          arrayOfApplicationInfo[m] = localApplicationInfo1;
          if (((m == 8) || (k == i - 1)) && (!this.b.a((float)this.d / (float)this.f, arrayOfString, arrayOfd, arrayOfApplicationInfo)))
            bool = false;
        }
      }
    }
    while (true)
    {
      return bool;
      k++;
      break;
      File localFile1 = Environment.getExternalStorageDirectory();
      if (localFile1 != null)
        bool = a(localFile1);
      else
        bool = true;
    }
  }
}

/* Location:           C:\Users\sandrocheng.21KUNPENG\Desktop\classes_dex2jar\
 * Qualified Name:     com.keniu.security.malware.bg
 * JD-Core Version:    0.6.2
 */